<!DOCTYPE html>
<html>
<head>
    <meta charset="UTF-8">
    <title>DataGrid Selection - jQuery EasyUI Demo</title>
    <link rel="stylesheet" type="text/css" href="../../lib/jquery-easyui/themes/default/easyui.css">
    <link rel="stylesheet" type="text/css" href="../../lib/jquery-easyui/themes/icon.css">
    <link rel="stylesheet" type="text/css" href="../../css/demo.css">

    <script type="text/javascript" src="../../lib/jquery-easyui/jquery.min.js"></script>
    <script type="text/javascript" src="../../lib/jquery-easyui/jquery.easyui.min.js"></script>
    <script type="text/javascript" src="../../lib/jquery-easyui/locale/easyui-lang-zh_CN.js"></script>
    <script type="text/javascript" src="../../lib/knockout/knockout-3.1.0.js"></script>
    <script type="text/javascript" src="../../js/constant.js"></script>
    <script type="text/javascript" src="../../js/utility.js"></script>
    <script type="text/javascript" src="pharseorder.js"></script>
    <style type="text/css">
        .subtotal { font-weight: bold; }/*合计单元格样式*/
    </style>
</head>
<body>
<div class="easyui-layout" data-options="fit:true">
    <div data-options="region:'north',split:false" style="height:38px; border-top: 0px">
        <div style="padding:5px; background:#fafafa; border:0px; solid:#ccc">
            <table cellpadding="0" cellspacing="0" style="width:100%">
                <tr>
                    <td style="padding-left:2px">
                        <a href="#" class="easyui-linkbutton" plain="true" iconCls="icon-add" onclick="newRep();">新增</a>
                        <a href="#" class="easyui-linkbutton" plain="true" iconCls="icon-save" onclick="save();">保存</a>
                        <a href="#" class="easyui-linkbutton" plain="true" iconCls="icon-reload">刷新</a>
                        <a href="#" class="easyui-linkbutton" plain="true" iconCls="icon-undo" onclick="reject();">撤销</a>
                        <a href="#" class="easyui-linkbutton" plain="true" iconCls="icon-print">打印</a>
                        <a href="#" class="easyui-linkbutton" plain="true" iconCls="icon-help"></a>
                    </td>
                    <td style="text-align:right;padding-right:2px">
                        <input class="easyui-searchbox" data-options="prompt:'Please input somthing'" style="width:200px"/>
                    </td>
                </tr>
            </table>
        </div>

    </div>
    <div data-options="region:'west',split:true" style="width:310px">
        <table id="dgList" class="easyui-datagrid" style="width:600px;height:100%"
               title="Load Data" iconCls="icon-save">
            <thead>
            <tr>
                <th field="bo_id" width="80px" formatter="formatCellTooltip">单据号</th>
                <th field="inv_date" width="80px" formatter="formatCellTooltip" sortable="true" sorter="compareDatetime">采购日期</th>
                <!--<th field="warehouse" width="80px" formatter="formatCellTooltip">仓库</th>
                <th field="inv_org" width="80px" formatter="formatCellTooltip">库存组织</th>
                <th field="warehouse_user" width="80px" formatter="formatCellTooltip">仓库员</th>-->
                <th field="supplier_user" width="80px" formatter="formatCellTooltip">供应商</th>
                <th field="transportation" width="80px" formatter="formatCellTooltip">运输方式</th>
                <th field="purchase_user" width="80px" formatter="formatCellTooltip">采购员</th>
                <th field="deliver_nation" width="80px" formatter="formatCellTooltip">发货国家</th>
                <th field="deliver_area" width="80px" formatter="formatCellTooltip">发货地区</th>
            </tr>
            </thead>
        </table>

    </div>
    <div data-options="region:'center'">
        <div class="easyui-layout" data-options="fit:true" style="border:0px">
            <div data-options="region:'north',split:true" style="height:200px;border:0px;">
                <table id="header" cellpadding="0" cellspacing="0" style="width:100%">
                    <tr style="height: 50px">
                        <td colspan="6" style="text-align: center"><strong style="font-size: 18px">采购订单</strong></td>
                    </tr>
                    <tr style="height: 35px">

                        <td style="width: 100px;text-align: right; vertical-align: middle; padding: 5px">
                            单据号
                        </td>
                        <td style="width: 180px;text-align: left; vertical-align: middle">

                            <input class="easyui-textbox" id="bo_id" style="width:200px" data-options="label:'Name:',onChange:onCodeChanged">

                        </td>
                        
                        <td style="width: 50px;text-align: right; vertical-align: middle; padding: 5px">
                            采购日期
                        </td>
                        <td style="width: 180px;text-align: left; vertical-align: middle">

                            <input class="easyui-datebox" id="inv_date" style="width:200px;"
                                   data-options="required:true,
                                   parser: function (date) { return new Date(Date.parse(date.replace(/-/g, '/'))); },
                                   onSelect: incomeDateSel
                                    ">

                        </td>
                        <td style="width: 80px;text-align: right; vertical-align: middle; padding: 5px">
                            供应商
                        </td>
                        <td style="width: 180px;text-align: left; vertical-align: middle">
                            <input class="easyui-textbox" id="supplier_user" style="width:200px;" data-options="label:'Name:',required:true,onChange:onSupUserChanged">
                        </td>
                    </tr>
					<tr style="height: 35px">	
						 <td style="width: 100px;text-align: right; vertical-align: middle; padding: 5px">
                            运费
                        </td>
						 <td style="width: 180px;text-align: left; vertical-align: middle">

                            <input id="transportationfee" class="easyui-textbox" style="width:200px;" data-options="label:'Name:',required:false,onChange:onTransportationfeeChanged">
                        </td>
                    
                  
                        <td style="width: 80px;text-align: right; vertical-align: middle; padding: 5px">
                            采购员
                        </td>
                        <td style="width: 180px;text-align: left; vertical-align: middle">
                            <input class="easyui-textbox" id="purchase_user" style="width:200px;" data-options="label:'Name:',required:true,onChange:onPurchaseUserChanged">
                        </td>
                        <td style="width: 100px;text-align: right; vertical-align: middle; padding: 5px;display:none">
                            采购组织
                        </td>
                        <td style="width: 180px;text-align: left; vertical-align: middle;display:none">

                            <input id="purchase_org" class="easyui-combotree" style="width:200px;" data-options="
                                       url:$channelURL + 'ocr-channel-manager/channel-org-mgr/findtree?context=3|3|lj|aaa',
                                        method:'get',

                                        panelHeight:'auto',
                                        onSelect: purchaseOrglSel,
                                        required:true">
                        </td>
						
						 
						 
						 
                        <td style="width: 80px;text-align: right; vertical-align: middle; padding: 5px">
                            采购部门
                        </td>
                        <td style="width: 180px;text-align: left; vertical-align: middle">
                            <input class="easyui-textbox" id="purchase_dept" style="width:200px;" data-options="label:'Name:',required:false,onChange:onPurchaseDeptChanged">
                        </td>
						 </tr>
					<tr style="height: 35px"> 
						 <td style="width: 100px;text-align: right; vertical-align: middle; padding: 5px">
                            运输方式
                        </td>
                        <td style="width: 180px;text-align: left; vertical-align: middle">

                            <input id="transportation" class="easyui-textbox" style="width:200px;" data-options="label:'Name:',required:false,onChange:onTransportationChanged">
                        </td>
                
                       
                        <td style="width: 80px;text-align: right; vertical-align: middle; padding: 5px">
                            发货国家
                        </td>
                        <td style="width: 180px;text-align: left; vertical-align: middle">
                            <input class="easyui-textbox" id="deliver_nation" style="width:200px;" data-options="label:'Name:',required:false,onChange:onDeliverNationChanged">
                        </td>
                        <td style="width: 80px;text-align: right; vertical-align: middle; padding: 5px">
                            发货地区
                        </td>
                        <td style="width: 180px;text-align: left; vertical-align: middle">
                            <input class="easyui-textbox" id="deliver_area" style="width:200px;" data-options="label:'Name:',required:true,onChange:onDeliverAreaChanged">
                        </td>
                    </tr>


                    
                    
                </table>
            </div>
            <div data-options="region:'center'" style="border:0px">
                <table id="detailDg" class="easyui-datagrid" style="border:0px"
                       title="采购订单明细" data-options="">
                    <thead>
                    <tr>
                        <th field="product_sku_code" width="80px" formatter="formatCellTooltip">SKU</th>
					    <th field="title" width="100px" formatter="formatCellTooltip">商品名</th>
                        <th field="sales_catelog" width="80px" formatter="formatCatelogsCol">品类</th>
                        <th field="bar_code" width="80px" formatter="formatCellTooltip" data-options="editor:{type:'barcodeEditor'}">条码</th>
                        <th field="specifications" width="80px" formatter="formatSpecificationCol">规格</th>
                        <th field="batch_code" width="80px" formatter="formatCellTooltip">批次号</th>
                        <th field="base_unit" width="80px" formatter="formatCellTooltip">单位</th>
                        <th field="nynum" width="80px" formatter="formatCellTooltip"  editor="{
                                                                    type:'numberbox',
                                                                    options:{
                                                                        precision:0,
                                                                        required:true
                                                                    }
                                                                } ">采购数量</th>
                        <th field="nsnum" width="80px" formatter="formatCellTooltip" hidden="true" editor="{
                                                                    type:'numberbox',
                                                                    options:{
                                                                        precision:0,
                                                                        required:true
                                                                    }
                                                                } ">实收数量</th>
                        <th field="unqualifiednum" width="80px" formatter="formatCellTooltip" hidden="true" editor="{
                                                                    type:'numberbox',
                                                                    options:{
                                                                        precision:0,
                                                                        required:true
                                                                    }
                                                                } ">不合格数量</th>

                       
                       
					   <th field="locations" width="80px" hidden="true" formatter="formatCellTooltip"
                            data-options="editor:{type:'locationsRef'} ">货位
                        </th>
						
						
                        <th field="shelflife"  width="80px" formatter="formatCellTooltip" editor="{
                                                                    type:'text',
                                                                    options:{

                                                                        required:true

                                                                    }
                                                                }">保质期</th>

                        <th field="shelflifeunit"  width="80px" formatter="formatCellTooltip" editor="{
                                                                    type:'text'

                                                                }">保质期单位</th>

                        <th field="expdate"  width="80px" formatter="formatCellTooltip" editor="{
                                                                    type:'text',
                                                                    options:{

                                                                        required:true

                                                                    }
                                                                }">失效日期</th>

                        <th field="su_batch_code"  width="80px" formatter="formatCellTooltip" editor="{
                                                                    type:'text'
                                                                }">供应商批号</th>

                        <th field="purchase_price" width="80px" formatter="formatCellTooltip" editor="{
                                                                    type:'numberbox',
                                                                    options:{
                                                                        precision:0,

                                                                    }
                                                                }">采购价</th>

                        <th field="supply_price" width="80px" formatter="formatCellTooltip" editor="{
                                                                    type:'numberbox',
                                                                    options:{
                                                                        precision:0,
                                                                       
                                                                    }
                                                                }">供货价</th>
                        <th field="supply_amount" width="80px" formatter="formatCellTooltip" editor="{
                                                                    type:'numberbox',
                                                                    options:{
                                                                        precision:0,
                                                                       
                                                                    }
                                                                }">金额</th>
                        <th field="discount" width="80px" formatter="formatCellTooltip" editor="{
                                                                    type:'numberbox',
                                                                    options:{
                                                                        precision:0,
                                                                     
                                                                    }
                                                                }">税率</th>
                        <th field="discount_amount" width="80px" formatter="formatCellTooltip" editor="{
                                                                    type:'numberbox',
                                                                    options:{
                                                                        precision:0,
                                                                      
                                                                    }
                                                                }">折扣</th>
                        <th field="brand" width="80px" formatter="formatCellTooltip">品牌</th>
                        <th field="manufacturer" width="80px" formatter="formatCellTooltip">制造商</th>
                        <th field="note" width="80px" formatter="formatCellTooltip" data-options="editor:{type:'text'}">备注</th>


                    </tr>
                    </thead>
                </table>

            </div>
            <div data-options="region:'south',split:true" style="height:80px;">
                <table cellpadding="0" cellspacing="0" style="width:100%;margin-top: 10px">
                    <tr style="height: 35px">
                        <td style="width: 100px;text-align: right; vertical-align: middle; padding: 5px">
                            制单人
                        </td>
                        <td style="width: 180px;text-align: left; vertical-align: middle">

                            <input class="easyui-textbox" name="operator" style="width:200px" data-options="label:'Name:',required:false">

                        </td>
                        <td style="width: 50px;text-align: right; vertical-align: middle; padding: 5px">
                            制单日期
                        </td>
                        <td style="width: 180px;text-align: left; vertical-align: middle">

                            <input class="easyui-textbox" name="bill_date" style="width:200px" data-options="label:'name:',required:false">

                        </td>
                        <td style="width: 80px;text-align: right; vertical-align: middle; padding: 5px">
                        </td>
                        <td style="width: 180px;text-align: left; vertical-align: middle">

                        </td>

                    </tr>
                </table>
            </div>
        </div>
    </div>
</div>

<!--商品参照-->
<div id="goodsRefDialog" class="easyui-window" title="商品选择" data-options="modal:true,closed:true,iconCls:'icon-save'"
     style="width:600px;height:400px;padding:5px;">
    <div class="easyui-layout" data-options="fit:true">
        <div data-options="region:'west',split:true" style="width:120px">
            <ul class="easyui-tree" id="catelogTree"  style="width:100%" data-options="
                                            url:$goodsURL + 'ocr-goods-center/sales-catelog-mgr/findtree?context=3|3|lj|aaa',
                                            method:'get',
                                            onSelect: catelogTreeSel"
                                            />
        </div>
        <div data-options="region:'center',split:true" style="padding:10px;">
            <table id="goodsDg" class="easyui-datagrid" style="width:100%;height:100%"
                   title="请选择商品" iconCls="icon-save">
                <thead>
                <tr>
                    <th field="product_sku_code" width="80px" formatter="formatCellTooltip">SKU</th>
                    <th field="title" width="80px" formatter="formatCellTooltip">商品名</th>
                    <th field="sales_catelog" width="80px" formatter="formatCatelogsCol">品类</th>
                    <th field="bar_code" width="80px" formatter="formatCellTooltip">条码</th>
                    <th field="specifications" width="80px" formatter="formatSpecificationCol">规格</th>
                    <th field="brand" width="80px" formatter="formatCellTooltip">品牌</th>
                    <th field="manufacturer" width="80px" formatter="formatCellTooltip">制造商</th>
                    <th field="base_unit" width="80px" formatter="formatCellTooltip">单位</th>
                    <!--<th field="supply_price" width="80px" formatter="formatCellTooltip">供货价</th>-->
                    <!--<th field="retail_price" width="80px" formatter="formatCellTooltip">零售价</th>-->
                    <!--<th field="commission" width="80px" formatter="formatCellTooltip">佣金</th>-->
                </tr>
                </thead>
            </table>

        </div>
        <div data-options="region:'south',border:false" style="text-align:right;padding:5px 0 0;">
            <!--<a class="easyui-linkbutton" data-options="iconCls:'icon-ok'" href="javascript:void(0)" onclick="goodsRefReturn();" style="width:80px">Ok</a>-->
            <a class="easyui-linkbutton" data-options="iconCls:'icon-cancel'" href="javascript:void(0)" onclick="closeGoodsRef();" style="width:80px">Cancel</a>
        </div>
    </div>
</div>

<!--商品参照-->
<div id="locationsRefDialog" class="easyui-window" title="货位选择"
     data-options="modal:true,closed:true,iconCls:'icon-save'"
     style="width:1000px;height:400px;padding:5px;">
    <div class="easyui-layout" data-options="fit:true">
        <div data-options="region:'west',split:true" style="width:120px">
            <ul class="easyui-tree" id="locationLst" style="width:100%" data-options="

                                            onSelect: locatonsTreeSel"/>
            <li id="fixed">固定货位</li>
            <li id="free">自由货位</li>
        </div>

        <div data-options="region:'center',split:true" style="padding:10px;">
            <table id="locationsDg" class="easyui-datagrid" style="width:100%;height:100%"
                   title="请选择货位" iconCls="icon-save">
                <thead>
                <tr>
                    <th field="locationref_warehousecode" width="80px" formatter="formatCellTooltip">仓库编码</th>
                    <th field="locationref_locationcode" width="80px" formatter="formatCellTooltip">货位编码</th>
					<th field="locationref_sku" width="170px" formatter="formatCellTooltip">物料SKU</th>
                    <th field="locationref_invbatchcode" width="80px" formatter="formatCellTooltip">物料批次</th>
                    <th field="locationref_onhandnum" width="80px" formatter="formatCellTooltip">现存数量</th>			
                    <th field="locationref_locationnum" width="80px" formatter="formatCellTooltip">满载数量</th>
					<th field="locationref_plusnum" width="80px" formatter="formatPrice">剩余数量</th>
                    <th field="locationref_packageunit" width="80px" formatter="formatCellTooltip">包装单位</th>					
					
                </tr>
                </thead>
            </table>	
			
        </div>
		
		
		
		
        <div data-options="region:'south',border:false" style="text-align:right;padding:5px 0 0;">
            <!--<a class="easyui-linkbutton" data-options="iconCls:'icon-ok'" href="javascript:void(0)" onclick="goodsRefReturn();" style="width:80px">Ok</a>-->
            <a class="easyui-linkbutton" data-options="iconCls:'icon-cancel'" href="javascript:void(0)"
               onclick="closeGoodsRef();" style="width:80px">Cancel</a>
        </div>
    </div>
</div>

<div id="win" class="easyui-window" title="新增采购入库明细" data-options="modal:true,closed:true,iconCls:'icon-save'"
     style="width:300px;height:900px;padding:5px;">
	  <table id="addNewGoodsDg"  cellpadding="0" cellspacing="0" style="width:100%">
                    <tr style="height: 10px">
                     
						<td style="width: 100px;text-align: right; vertical-align: middle; padding: 5px" >
                             <strong style="font-size: 15px"><font color="DeepSkyBlue">采购信息</font></strong>
                        </td>
                    </tr>
										
                    <tr style="height: 35px">
                        <td style="width: 100px;text-align: right; vertical-align: middle; padding: 5px">
                             商品
                        </td>
                        <td style="width: 180px;text-align: left; vertical-align: middle">
								<input id="ref_good"  style='width:170px'>
								<input type="hidden" id="ref_goods" >
								<button style='width: 23px; height: 23px' onclick='showGoodsRefDialog();'>...</button>
                        </td>  
					</tr>
					
					<tr style="height: 35px">							
						<td style="width: 100px;text-align: right; vertical-align: middle; padding: 5px">
                            保质期
                        </td>
							 
						 <td style="width: 180px;text-align: left; vertical-align: middle">	
							<input  id="ref_shelflife" style='width:170px' value="">	
						</td> 						
                    </tr>		

				    <tr style="height: 35px">							
						<td style="width: 100px;text-align: right; vertical-align: middle; padding: 5px">
                            保质期单位
                        </td>
						 
						 
						 <td style="width: 180px;text-align: left; vertical-align: middle">	
							<input  id="ref_shelflifeunit" style='width:170px' value="天">	
						</td> 						
                    </tr>		
				    
					<tr style="height: 35px">							
						<td style="width: 100px;text-align: right; vertical-align: middle; padding: 5px">
                           失效日期
                        </td>
						 
						 
						 <td style="width: 180px;text-align: left; vertical-align: middle">	
							<input type="hidden" id="ref_expdatestr" >
							  <input class="easyui-datebox" id="ref_expdate" style="width:175px;"
                                   data-options="
                                   parser: function (date) { return new Date(Date.parse(date.replace(/-/g, '/'))); },
                                   onSelect: refExpdateDateSel
                                    ">
						</td> 						
                    </tr>
					
					<tr style="height: 35px">							
						<td style="width: 100px;text-align: right; vertical-align: middle; padding: 5px">
                          供应商批次号
                        </td>
						 	 
						 <td style="width: 180px;text-align: left; vertical-align: middle">	
							<input  id="ref_su_batch_code" style='width:170px' value="">	
						</td> 						
                    </tr>			
									
					<tr style="height: 10px">
                       
						<td style="width: 100px;text-align: right; vertical-align: middle; padding: 5px;display:none">
                            <strong style="font-size: 15px"><font color="DeepSkyBlue">入库信息</font></strong>
                        </td>
                    </tr>
					<tr style="height: 35px">
						<td style="width: 100px;text-align: right; vertical-align: middle; padding: 5px;display:none">
                             应收数量
                        </td>
						<td style="width: 180px;text-align: left; vertical-align: middle;display:none">
								<input id="ref_nynum" style="width:170px" value="0.0" >
					    </td>  
					</tr>	
					
				     <tr style="height: 35px">
						<td style="width: 100px;text-align: right; vertical-align: middle; padding: 5px;display:none">
                             实收数量
                        </td>
						<td style="width: 180px;text-align: left; vertical-align: middle;display:none">						
							<input  id="ref_nsnum" style='width:170px' value="0.0">
						</td> 
					</tr>		
							
					<tr style="height: 35px">							
						<td style="width: 100px;text-align: right; vertical-align: middle; padding: 5px;display:none">
                            不合格数量
                        </td>
						 						 
						 <td style="width: 180px;text-align: left; vertical-align: middle;display:none">	
							<input  id="ref_unqualifiednum" style='width:170px' value="0.0">	
						</td> 						
                    </tr>	

							
	
	 </table>
	 	 <div data-options="region:'south',border:false" style="text-align:right;padding:5px 0 0;">
            <!--<a class="easyui-linkbutton" data-options="iconCls:'icon-ok'" href="javascript:void(0)" onclick="goodsRefReturn();" style="width:80px">Ok</a>-->
			<a class="easyui-linkbutton" data-options="iconCls:'icon-ok'" href="javascript:void(0)" onclick="goodsRefReturnAppend();" style="width:80px">Ok</a>
          
        </div>
</div>


</body>

<script type="text/javascript">
    dgListSetting();
    detailListSetting();
    loadDgList();
</script>
</html>